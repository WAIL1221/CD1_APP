# worker_processes auto;
# events {
#     worker_connections 8000;
#     multi_accept on;
# }
#
# http {
#     include /etc/nginx/mime.types;
#     default_type application/octet-stream;
#
#     # Configuration pour la compression des réponses et des en-têtes de sécurité
#     gzip on;
#     gzip_disable "msie6";
#     gzip_vary on;
#     gzip_proxied any;
#     gzip_comp_level 6;
#     gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
#
#     log_format compression '$remote_addr - $remote_user [$time_local] '
#         '"$request" $status $upstream_addr '
#         '"$http_referer" "$http_user_agent"';
#
#     # Amélioration de la configuration des headers pour la sécurité
#     add_header X-Frame-Options "SAMEORIGIN";
#     add_header X-Content-Type-Options "nosniff";
#     add_header X-XSS-Protection "1; mode=block";
#
#     # HTTP Server block to handle direct HTTP traffic and redirect to HTTPS
#     server {
#         listen 80;
#         server_name enfant.innova.ma www.enfant.innova.ma;
#
#         access_log /var/log/nginx/access.log compression;
#         root /usr/share/nginx/html;
#         index index.html index.htm;
#
#         # Redirection de toutes les requêtes HTTP vers HTTPS
#         return 301 https://$host$request_uri;
#
#         # Serveur les fichiers statiques et permettre le caching
#         location / {
#             try_files $uri $uri/ /index.html;
#         }
#
#         # Configuration de caching pour les fichiers multimédia
#         location ~* \.(jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc)$ {
#             expires 1M;
#             access_log off;  # Désactiver le logging pour améliorer les performances
#             add_header Cache-Control "public, must-revalidate, proxy-revalidate";
#             add_header Access-Control-Allow-Origin '*';
#             add_header Access-Control-Allow-Credentials 'true';
#         }
#
#         # Configuration de caching pour CSS et JS
#         location ~* \.(css|js)$ {
#             try_files $uri =404;
#             expires 1y;
#             access_log off;  # Désactiver le logging pour améliorer les performances
#             add_header Cache-Control "public, must-revalidate, proxy-revalidate";
#         }
#
#         # Bloquer l'accès aux fichiers cachés (fichiers commençant par un point)
#         location ~ /\. {
#             deny all;
#         }
#     }
#
#     # HTTPS Server block to handle secure requests
#     server {
#         listen 443 ssl;
#         server_name enfant.innova.ma www.enfant.innova.ma;
#
#         ssl_certificate /etc/nginx/certs/enfant.innova.ma.crt;
#         ssl_certificate_key /etc/nginx/private/enfant.innova.ma.key;
#
#         access_log /var/log/nginx/access.log compression;
#         root /usr/share/nginx/html;
#         index index.html index.htm;
#
#         # Serveur les fichiers statiques et permettre le caching
#         location / {
#             try_files $uri $uri/ /index.html;
#         }
#
#         # Configuration de caching pour les fichiers multimédia
#         location ~* \.(jpg|jpeg|gif|png|ico|cur|gz|svg|svgz|mp4|ogg|ogv|webm|htc)$ {
#             expires 1M;
#             access_log off;  # Désactiver le logging pour améliorer les performances
#             add_header Cache-Control "public, must-revalidate, proxy-revalidate";
#             add_header Access-Control-Allow-Origin '*';
#             add_header Access-Control-Allow-Credentials 'true';
#         }
#
#         # Configuration de caching pour CSS et JS
#         location ~* \.(css|js)$ {
#             try_files $uri =404;
#             expires 1y;
#             access_log off;  # Désactiver le logging pour améliorer les performances
#             add_header Cache-Control "public, must-revalidate, proxy-revalidate";
#         }
#
#         # Bloquer l'accès aux fichiers cachés (fichiers commençant par un point)
#         location ~ /\. {
#             deny all;
#         }
#     }
# }

# # Redirect requests for localhost and IP to the domain
# # server {
# #     listen 80;
# #     listen 443 ssl;
# #     server_name localhost ; #you may add your public ip address to be redirected to the domain name
# #
# #     ssl_certificate /etc/ssl/certs/enfant.innova.ma.crt;
# #     ssl_certificate_key /etc/ssl/private/enfant.innova.ma.key;
# #
# #     return 301 https://enfant.innova.ma$request_uri;
# # }
#
# #To unable the domaine name resolution write this tree lines of code bellow in the following path :
# # For Linux :   /etc/hosts
# # For Windows : C:\Windows\System32\drivers\etc
#
# #added by wail_hadad_api_crud
# # 127.0.0.1 enfant.innova.ma
# # 127.0.0.1 www.enfant.innova.ma
#
# # HTTP Server block to handle direct HTTP traffic and redirect to HTTPS
# server {
#     listen 80;
# #    listen  160.168.135.79;  # Listen on the specific public IP address
#     server_name enfant.innova.ma www.enfant.innova.ma;
#     return 301 https://$host$request_uri;
# }
#
# # HTTPS Server block to handle secure requests
# server {
#     listen 443 ssl;
#     server_name enfant.innova.ma www.enfant.innova.ma;
#
#     ssl_certificate /etc/ssl/certs/enfant.innova.ma.crt;
#     ssl_certificate_key /etc/ssl/private/enfant.innova.ma.key;
#
#     location / {
#         proxy_pass http://frontend:8080;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#     }
#
# #This is optional to see the JSON fetching response ,
# #you can adjust the paths according to your project
#     location /api/prof {
#         proxy_pass http://backend:8000/api/Profs;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#     }
#
#     location /api/etudiant {
#         proxy_pass http://backend:8000/api/Etudiants;
#         proxy_set_header Host $host;
#         proxy_set_header X-Real-IP $remote_addr;
#         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#         proxy_set_header X-Forwarded-Proto $scheme;
#     }
# }




# # Redirect requests for localhost and IP to the domain
# server {
#     listen 80;
#     listen 443 ssl;
#     server_name localhost 105.159.77.27;
#
#     ssl_certificate /etc/ssl/certs/enfant.innova.ma.crt;
#     ssl_certificate_key /etc/ssl/private/enfant.innova.ma.key;
#
#     return 301 https://$host$request_uri;
# }

#To unable the domaine name resolution write this tree lines of code bellow in the following path :
# For Linux :   /etc/hosts
# For Windows : C:\Windows\System32\drivers\etc

#added by wail_hadad_api_crud
# 127.0.0.1 enfant.innova.ma
# 127.0.0.1 www.enfant.innova.ma

server {
    listen 80;
    listen 13.60.9.127:80;  # Listen on the specific public IP address
    server_name enfant.innova.ma www.enfant.innova.ma;
    return 301 https://$host$request_uri;
}

# HTTPS Server block to handle secure requests
server {
    listen 443 ssl;
    server_name enfant.innova.ma www.enfant.innova.ma;

    ssl_certificate /etc/ssl/certs/enfant.innova.ma.crt;
    ssl_certificate_key /etc/ssl/private/enfant.innova.ma.key;

    location / {
        proxy_pass http://frontend:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}


                location /api/test {
#                     proxy_pass http://backend:8000/api/show/offers/remaining;
                    proxy_pass http://13.60.9.127:8000/api/show/activities;
                    proxy_set_header Host $host;
                    proxy_set_header X-Real-IP $remote_addr;
                    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                    proxy_set_header X-Forwarded-Proto $scheme;
                }
            #
            #     location /api/etudiant {
            #         proxy_pass http://backend:8000/api/Etudiants;
            #         proxy_set_header Host $host;
            #         proxy_set_header X-Real-IP $remote_addr;
            #         proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
            #         proxy_set_header X-Forwarded-Proto $scheme;
            #     }
